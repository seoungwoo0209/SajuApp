# 사주 카페 - 지장간 업데이트 (v1.4.1)

## 주요 변경사항

### 1. 지장간 구조 개선
지장간을 **여기(餘氣) / 중기(中氣) / 정기(正氣)** 로 구분하여 저장하도록 변경했습니다.

#### 개념 설명
- **여기(餘氣)**: 이전 계절의 흔적. 이미 중심에서 물러났지만 완전히 사라지지 않은 기운
- **중기(中氣)**: 다음 계절의 준비. 아직 전면에 드러나지 않았지만 준비되고 있는 기운
- **정기(正氣)**: 현재의 중심. 해당 지지를 대표하는 가장 안정적인 기운

#### 데이터 구조
```javascript
"寅": [
  {stem: "戊", role: "여기"},
  {stem: "丙", role: "중기"},
  {stem: "甲", role: "정기"}
]
```

### 2. 12지지 지장간 구성 (이미지 기준)
| 지지 | 여기(餘氣) | 중기(中氣) | 정기(正氣) |
|------|-----------|-----------|-----------|
| 子(자) | 壬(임) | - | 癸(계) |
| 丑(축) | 癸(계) | 辛(신) | 己(기) |
| 寅(인) | 戊(무) | 丙(병) | 甲(갑) |
| 卯(묘) | 甲(갑) | - | 乙(을) |
| 辰(진) | 乙(을) | 癸(계) | 戊(무) |
| 巳(사) | 戊(무) | 庚(경) | 丙(병) |
| 午(오) | 丙(병) | 己(기) | 丁(정) |
| 未(미) | 丁(정) | 乙(을) | 己(기) |
| 申(신) | 戊(무) | 壬(임) | 庚(경) |
| 酉(유) | 庚(경) | - | 辛(신) |
| 戌(술) | 辛(신) | 丁(정) | 戊(무) |
| 亥(해) | 戊(무) | 甲(갑) | 壬(임) |

### 3. 새로운 유틸리티 함수

```javascript
// 정기 조회 - 해당 지지의 중심 기운
getJeonggi(branch)  

// 여기 조회 - 이전 계절의 흔적
getYeogi(branch)

// 중기 조회 - 다음 계절의 준비
getJunggi(branch)

// 특정 역할의 지장간 조회
getHiddenStemsByRole(branch, role)

// 전체 지장간 정보 반환 (역할 포함)
getAllHiddenStemsWithRole(branch)

// 하위 호환성: 천간만 배열로 반환
getHiddenStemsOnly(branch)
```

### 4. UI 개선
지장간 탭에서 각 천간 옆에 역할이 색상으로 표시됩니다:
- **여기**: 초록색
- **중기**: 주황색
- **정기**: 파란색

### 5. 향후 활용
이제 대운 분석이나 인생총운 계산 시 지장간의 역할에 따라 다른 가중치를 적용할 수 있습니다:
- 정기: 강한 영향력
- 중기: 중간 영향력
- 여기: 약한 영향력

## 사용 방법
모든 파일을 같은 폴더에 넣고 `index.html`을 브라우저에서 열면 됩니다.

## 파일 구조
```
├── index.html          # 메인 HTML
├── style.css           # 스타일시트
├── saju_core.js        # 사주 계산 엔진 (지장간 구조 개선)
├── saju_fortune.js     # 총운 해석 엔진
└── background.jpg      # 배경 이미지
```

## 기술적 변경사항
1. `HIDDEN_STEMS_BRANCH` 객체를 배열에서 객체 배열로 변경
2. 각 지장간에 `stem`과 `role` 속성 추가
3. `getWuxingCounts`, `getYinYangCounts`, `renderHiddenList` 함수 수정
4. CSS에 역할 표시 스타일 추가

## 버전
- v1.4.1 (2026-01-28): 지장간 여중기 구분 추가
- v1.4: 대운 중심 총운 시스템
