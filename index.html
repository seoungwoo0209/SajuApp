<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ì‚¬ì£¼ ì¹´í˜ (v1.4)</title>
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <div class="bg"></div>
  <div class="overlay"></div>

  <main class="app">
    <header class="top">
      <div class="brand">
        <div class="logo">â˜¯</div>
        <div>
          <div class="title">ì‚¬ì£¼ ì¹´í˜</div>
          <div class="subtitle">ì •ì  ì›¹ì•± Â· 3íŒŒì¼ êµ¬ì¡° Â· v1.4 ëŒ€ìš´ì¤‘ì‹¬</div>
        </div>
      </div>
      <div id="globalBadges" class="badges"></div>
    </header>

    <section class="panel">
      <div class="form">
        <label>
          <span>ì´ë¦„(ì˜µì…˜)</span>
          <input id="name" type="text" placeholder="ì¶”ìŠ¹ìš°" />
        </label>

        <label>
          <span>ìƒë…„ì›”ì¼(ì–‘ë ¥)</span>
          <input id="birthDate" type="date" required />
        </label>

        <label>
          <span>ì¶œìƒì‹œê°(í•„ìˆ˜)</span>
          <input id="birthTime" type="time" required />
        </label>

        <label>
          <span>ì„±ë³„</span>
          <select id="gender">
            <option value="M" selected>ë‚¨</option>
            <option value="F">ì—¬</option>
          </select>
        </label>

        <div id="alert" class="alert hidden"></div>
      </div>

      <nav class="tabs">
        <button class="tab active" data-tab="tab-saju">ì‚¬ì£¼</button>
        <button class="tab" data-tab="tab-hidden">ì§€ì¥ê°„</button>
        <button class="tab" data-tab="tab-shishen">ì‹­ì‹ </button>
        <button class="tab" data-tab="tab-daeun">ëŒ€ìš´</button>
        <button class="tab" data-tab="tab-analysis">ê²©/ìš©í¬ê¸°í•œ</button>
      </nav>

      <section id="tab-saju" class="tabpane active">
        <div class="grid2">
          <div class="card">
            <div class="card-title">4ì£¼(ì—°/ì›”/ì¼/ì‹œ)</div>
            <div class="pillars">
              <div class="pillar">
                <div class="p-label">ë…„ì£¼</div>
                <div class="p-ganji" id="p-year">-</div>
              </div>
              <div class="pillar">
                <div class="p-label">ì›”ì£¼</div>
                <div class="p-ganji" id="p-month">-</div>
              </div>
              <div class="pillar">
                <div class="p-label">ì¼ì£¼</div>
                <div class="p-ganji" id="p-day">-</div>
              </div>
              <div class="pillar">
                <div class="p-label">ì‹œì£¼</div>
                <div class="p-ganji" id="p-hour">-</div>
              </div>
            </div>
            <div class="tiny" id="dayMaster">ì¼ê°„: -</div>
          </div>

          <div class="card">
            <div class="card-title">ì˜¤í–‰(í‘œë©´ 8ê¸€ì)</div>
            <div id="top2" class="top2">-</div>
            <div class="bars" id="barsSurface"></div>
          </div>
        </div>
      </section>

      <section id="tab-hidden" class="tabpane">
        <div class="grid2">
          <div class="card">
            <div class="card-title">ì§€ì¥ê°„(ê° ì§€ì§€ë³„)</div>
            <div id="hiddenList" class="hiddenlist">-</div>
          </div>

          <div class="card">
            <div class="card-title">ì˜¤í–‰(ì§€ì¥ê°„ í¬í•¨)</div>
            <div class="tiny">â€» ì§€ì§€ 1ê°œë‹¹ ì§€ì¥ê°„ ëª¨ë‘ +1 ë‹¨ìˆœí•©(ê°€ì¤‘ì¹˜ ì—†ìŒ)</div>
            <div class="bars" id="barsHidden"></div>
          </div>
        </div>
      </section>

      <section id="tab-shishen" class="tabpane">
        <div class="grid2">
          <div class="card">
            <div class="card-title">ì²œê°„ ì‹­ì‹  (ì‚¬ì£¼íŒ”ì)</div>
            <div id="shishenPillars" class="shishen-pillars">-</div>
          </div>

          <div class="card">
            <div class="card-title">ì§€ì¥ê°„ ì‹­ì‹ </div>
            <div id="shishenHidden" class="hiddenlist">-</div>
          </div>
        </div>
      </section>

      <section id="tab-daeun" class="tabpane">
        <div class="card">
          <div class="card-title">ëŒ€ìš´ ì •ë³´</div>
          <div id="daeunMeta" class="tiny muted">ëŒ€ìš´ ì‹œì‘: - / ë°©í–¥: -</div>
        </div>

        <div id="daeunList" class="daeun-list">
          <!-- ëŒ€ìš´ ì¹´ë“œë“¤ì´ ì—¬ê¸° ë Œë”ë§ -->
        </div>
      </section>
      
      <!-- ìƒˆë¡œìš´ íƒ­: ê²©/ìš©í¬ê¸°í•œ/ì´ì  -->
      <section id="tab-analysis" class="tabpane">
        <div class="grid2">
          <div class="card">
            <div class="card-title">ê²©(æ ¼) ë¶„ì„</div>
            <div id="geokInfo">-</div>
          </div>
          
          <div class="card">
            <div class="card-title">ì‹ ê°•/ì‹ ì•½</div>
            <div id="strengthInfo">-</div>
          </div>
        </div>
        
        <div class="card" style="margin-top: 12px;">
          <div class="card-title">ìš©í¬ê¸°í•œ(ç”¨å–œå¿Œé–‘)</div>
          <div id="godsInfo">-</div>
        </div>
        
        <div class="card" style="margin-top: 12px;">
          <div class="card-title">ì›êµ­ ì´ì </div>
          <div class="profile-selector">
            <label>
              <input type="radio" name="profile" value="overall" checked onchange="window.SajuUI.onProfileChange('overall')">
              <span>ì¢…í•©</span>
            </label>
            <label>
              <input type="radio" name="profile" value="love" onchange="window.SajuUI.onProfileChange('love')">
              <span>ì—°ì• </span>
            </label>
            <label>
              <input type="radio" name="profile" value="money" onchange="window.SajuUI.onProfileChange('money')">
              <span>ì¬ë¬¼</span>
            </label>
          </div>
          <div id="baseScore">-</div>
        </div>
      </section>
    </section>

  </main>

  <!-- ì‚¬ì£¼ ê³„ì‚° ì—”ì§„ (ì›êµ­/ëŒ€ìš´ ìƒì„±) -->
  <script src="./saju_core.js?v=8"></script>
  
  <!-- ë°ì´í„° ë ˆì´ì–´ (inline í†µí•©) -->
  <script>
    console.log("ğŸ”¥ SajuData í†µí•© ì‹œì‘");
    
    window.SajuData = window.SajuData || {};
    
    // saju_core ìƒìˆ˜ í†µí•©
    if (typeof WUXING_STEM !== 'undefined') {
      window.SajuData.WUXING_STEM = WUXING_STEM;
      window.SajuData.WUXING_BRANCH = WUXING_BRANCH;
      window.SajuData.WUXING_GENERATES = WUXING_GENERATES;
      window.SajuData.WUXING_CONTROLS = WUXING_CONTROLS;
    }
    
    // ì‹­ì‹  í•œê¸€ëª…
    if (typeof SHISHEN_NAMES !== 'undefined') {
      window.SajuData.TEN_GODS_KR = SHISHEN_NAMES;
    }
    
    // ì¶© í…Œì´ë¸”
    if (typeof CHUNG_PAIRS !== 'undefined') {
      window.SajuData.EARTHLY_CLASHES = CHUNG_PAIRS;
    }
    
    // ì§€ì¥ê°„ ë³€í™˜
    if (typeof HIDDEN_STEMS_BRANCH !== 'undefined') {
      window.SajuData.HIDDEN_STEMS_RATIO = {};
      const roleToRatio = { "ì—¬ê¸°": 0.6, "ì¤‘ê¸°": 0.25, "ì •ê¸°": 0.15 };
      Object.keys(HIDDEN_STEMS_BRANCH).forEach(branch => {
        const stems = HIDDEN_STEMS_BRANCH[branch];
        window.SajuData.HIDDEN_STEMS_RATIO[branch] = stems.map(item => ({
          stem: item.stem,
          ratio: stems.length === 1 ? 1.0 : (
            stems.length === 2 && item.role === "ì—¬ê¸°" ? 0.7 :
            stems.length === 2 && item.role === "ì •ê¸°" ? 0.3 :
            roleToRatio[item.role] || 0.5
          )
        }));
      });
    }
    
    // SEASON_MAP (saju_coreì— ì—†ìŒ)
    window.SajuData.SEASON_MAP = {
      "å¯…": "spring", "å¯": "spring", "è¾°": "spring",
      "å·³": "summer", "åˆ": "summer", "æœª": "summer",
      "ç”³": "autumn", "é…‰": "autumn", "æˆŒ": "autumn",
      "äº¥": "winter", "å­": "winter", "ä¸‘": "winter"
    };
    
    window.SajuData.SEASON_ELEMENT = {
      "spring": "wood",
      "summer": "fire",
      "autumn": "metal",
      "winter": "water"
    };
    
    // ìœ¡í•©
    window.SajuData.EARTHLY_SIX_COMBINATIONS = [
      ["å­", "ä¸‘"], ["å¯…", "äº¥"], ["å¯", "æˆŒ"], ["è¾°", "é…‰"], ["å·³", "ç”³"], ["åˆ", "æœª"]
    ];
    
    // ì‚¼í•©
    window.SajuData.EARTHLY_THREE_COMBINATIONS = [
      { name: "ç”³å­è¾° ìˆ˜êµ­", branches: ["ç”³", "å­", "è¾°"], element: "water" },
      { name: "äº¥å¯æœª ëª©êµ­", branches: ["äº¥", "å¯", "æœª"], element: "wood" },
      { name: "å¯…åˆæˆŒ í™”êµ­", branches: ["å¯…", "åˆ", "æˆŒ"], element: "fire" },
      { name: "å·³é…‰ä¸‘ ê¸ˆêµ­", branches: ["å·³", "é…‰", "ä¸‘"], element: "metal" }
    ];
    
    // ì²œê°„ì˜¤í•© (ì¶”ê°€!)
    window.SajuData.HEAVENLY_COMBINATIONS = [
      ["ç”²", "å·±"], ["ä¹™", "åºš"], ["ä¸™", "è¾›"], ["ä¸", "å£¬"], ["æˆŠ", "ç™¸"]
    ];
    
    // í˜• (ì¶”ê°€!)
    window.SajuData.EARTHLY_PUNISHMENTS = [
      ["å¯…", "å·³", "ç”³"],
      ["ä¸‘", "æœª", "æˆŒ"],
      ["å­", "å¯"]
    ];
    
    // ê²©ë³„ ì„ í˜¸ ì¶•
    window.SajuData.GEOK_PREFERENCE = {
      "ì‹ì‹ ê²©": { prefer: ["é£Ÿç¥"], support: ["æ­£è²¡", "åè²¡"], avoid: ["åå°", "åŠ«è²¡"] },
      "ìƒê´€ê²©": { prefer: ["å‚·å®˜"], support: ["åè²¡", "æ­£è²¡"], avoid: ["æ­£å®˜"] },
      "ì •ì¬ê²©": { prefer: ["æ­£è²¡"], support: ["é£Ÿç¥", "å‚·å®˜", "æ­£å®˜"], avoid: ["åŠ«è²¡"] },
      "í¸ì¬ê²©": { prefer: ["åè²¡"], support: ["é£Ÿç¥", "å‚·å®˜"], avoid: ["åŠ«è²¡", "æ¯”è‚©"] },
      "ì •ê´€ê²©": { prefer: ["æ­£å®˜"], support: ["æ­£å°", "åå°", "æ­£è²¡"], avoid: ["å‚·å®˜"] },
      "í¸ê´€ê²©": { prefer: ["åå®˜"], support: ["é£Ÿç¥", "æ­£å°"], avoid: ["å‚·å®˜"] },
      "ì •ì¸ê²©": { prefer: ["æ­£å°"], support: ["æ¯”è‚©", "æ­£å®˜"], avoid: ["åè²¡"] },
      "í¸ì¸ê²©": { prefer: ["åå°"], support: ["åŠ«è²¡", "åå®˜"], avoid: ["é£Ÿç¥"] },
      "ë¹„ê²¬ê²©": { prefer: ["æ¯”è‚©"], support: ["é£Ÿç¥", "å‚·å®˜", "åå®˜"], avoid: ["æ­£è²¡", "åè²¡"] },
      "ê²ì¬ê²©": { prefer: ["åŠ«è²¡"], support: ["å‚·å®˜", "åå®˜"], avoid: ["æ­£è²¡"] },
      "í˜¼í•©ê²©": { prefer: [], support: [], avoid: [] }
    };
    
    // í”„ë¡œíŒŒì¼
    window.SajuData.PROFILES = {
      overall: {
        tenGods: { "æ¯”è‚©": 5, "åŠ«è²¡": 4, "é£Ÿç¥": 6, "å‚·å®˜": 5, "åè²¡": 6, "æ­£è²¡": 6, "åå®˜": 5, "æ­£å®˜": 6, "åå°": 5, "æ­£å°": 6 },
        interactions: { "í•©": 2, "ì¶©": -3, "í˜•": -2, "íŒŒ": -2, "í•´": -1 }
      },
      love: {
        tenGods: { "æ­£è²¡": 10, "åè²¡": 8, "æ­£å®˜": 10, "åå®˜": 8, "é£Ÿç¥": 7, "å‚·å®˜": 6, "æ¯”è‚©": -2, "åŠ«è²¡": -5, "æ­£å°": 2, "åå°": 1 },
        interactions: { "í•©": 3, "ì¶©": -4, "í˜•": -3, "íŒŒ": -3, "í•´": -2 }
      },
      money: {
        tenGods: { "é£Ÿç¥": 9, "å‚·å®˜": 10, "æ­£è²¡": 9, "åè²¡": 10, "æ­£å®˜": 6, "åå®˜": 4, "æ­£å°": 3, "åå°": 2, "æ¯”è‚©": -5, "åŠ«è²¡": -10 },
        interactions: { "í•©": 2, "ì¶©": -4, "í˜•": -3, "íŒŒ": -2, "í•´": -1 }
      }
    };
    
    console.log("âœ… SajuData í†µí•© ì™„ë£Œ:", window.SajuData);
  </script>
  
  <!-- ìƒˆë¡œìš´ ì—”ì§„ -->
  <script src="./saju_engine.js?v=8"></script>
  <script src="./saju_ui.js?v=8"></script>
</body>
</html>
